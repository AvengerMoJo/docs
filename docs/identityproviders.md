# Identity Providers 

Auth0 is an "identity hub" that supports a number of authentication providers using different protocols: OAuth2, WS-Federation, etc. 

Auth0 supports:

1. Enterprise: __Active Directory__, __ADFS__, __LDAP__, __Google Apps__, __Office365__, __SQL__
2. Social: __Amazon__, __Facebook__, __LinkedIn__, __Twitter__, __Microsoft Account__, __Google__, __PayPal__, __GitHub__, __vKontakte__, __37Signals__, __Box__.

![](img/auth0-idp.png)

Auth0 sits in between your app and the system that authenticate your users. 

> The relationship between Auth0 and each of these authentication providers is called a 'connection'

Auth0 abstracts the handshake between the identity providers and your app, so you don't need to worry about their idiosyncracies and details (and nuances).

Auth0 is a multi-tenant service. When you register in Auth0 you get your own namespace (@@account.namespace@@). Many of these identity providers require registration and you will need to configure a `return url`. This will always be:

	https://@@account.namespace@@/login/callback

---

##Enterprise Identity Providers

### Google Apps
Google Apps uses OAuth2 and you have the option to request more advanced API access or user's attributes. In particular, you can query to which groups the user belongs to.

This is useful if your service is used by a company with users in Google Apps, and you want to drive authorization based on the group membership. You can write rules like: "anyone from __Marketing__ can read from my app", "anyone from __Sales__ can create new proposals", etc.

In this examples, membership to the _Sales_ and _Marketing_ groups is information kept in Google Apps, not your own app.

> This is a good thing, as you won't need to manage this membership information in your app. Your customers will also be happy as they would only need to manage this in one place. 

####1. Register Auth0 with Google
Use Google's API console for this. See [here](goog-clientid) for full instructions. 

####2. Enter the Client ID and Client Secret
Copy the `clientId` and `clientSecret` generated by Google on your connection settings. 

####3. Edit the callback URL
Make sure the callback address in Google is configured to

        https://@@account.namespace@@/login/callback

--- 

### Office 365
Office 365 uses [WS-Federation](http://docs.oasis-open.org/wsfed/federation/v1.2/os/ws-federation-1.2-spec-os.html) and SAML tokens. Auth0 will handle the protocol transition between your app (that continues to use OAuth2) and O365.

####1. Register Auth0 with Office365
You need to use Microsoft's [Seller Dashboard](https://sellerdashboard.microsoft.com). See [here](o365-clientid) for full instructions. 

####2. Enter the Client ID and Client Secret
Once you get a `clientId` and `clientSecret` enter them into the connection's settings.

> Why does Office365 need a `clientId` and `clientSecret` if it uses WS-Federation? Because querying Windows Azure Active Directory uses OAuth authentication. 

---

### Active Directory Federation Services
ADFS is frequently used in companies that have deployed Active Directory. To add a an ADFS connection you just need the enter the public address of the ADFS server. 

![](img/adfs-connection.png)

Auth0 will automatically download the __WS-FederationMetadata__ from the endpoint:

	https://{YOUR ADFS SERVER}/FederationMetadata/2007-06/FederationMetadata.xml

And import all configuration from there.

Auth0 will also generate a PowerShell script to automate the configuration of the ADFS server to recognize Auth0 as a __Relying Party__, and to issue a standard set of claims:

|Claim                            					                 | Description 		   |
|====================================================================|=====================|
|http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress  | e-mail    		   | 
|http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name          | User's name 		   |
|http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier| A unique identifier |
|http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname     | Given name    	   |
|http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname       | User's lastname 	   |

>Even though this connection is named "ADFS", it would actually work with any [WS-Federation](http://docs.oasis-open.org/wsfed/federation/v1.2/os/ws-federation-1.2-spec-os.html) compliant server. The customized PowerShell script is ADFS 2.0 specific though.

---

##Social Identity Providers

### Google OAuth2

This is one of the simplest connections you can enable in Auth0. Just go to "Connections/Social" and enable it:

![](img/goog-oauth2-connection.png)

Follow these instructions:

####1. Register Auth0 with Google
Use Google's API console for this. See [here](goog-clientid) for full instructions. 

####2. Enter the Client ID and Client Secret
Copy the `clientId` and `clientSecret` generated by Google on your connection settings. 

####3. Edit the callback URL
Make sure the callback address in Google is configured to

        https://@@account.namespace@@/login/callback

> This connection will work even if you don't enter a `clientId` or a `clientSecret`. You will not be able to query Google for other user properties, but you will be able to login anyway. This is because Auth0 is pre-provisioned with Google. After authentication you will be redirected to https://login.auth0.com instead of your tenant specific URL (https://@@account.namespace@@). There will be an extra redirect though. If you want to avoid it, then follow the steps described above.

---

###Microsoft Accounts
This one is very similar to Google OAuth.

####1. Register Auth0 with Microsoft
Use the Live Connect Developer Center. See [here](ms-account-clientid) for full instructions. 

####2. Enter the Client ID and Client Secret
Copy the `clientId` and `clientSecret` generated by Microsoft on your connection settings. 

####3. Edit the callback URL
Make sure the callback address in Microsoft Account is configured to

        https://@@account.namespace@@/login/callback